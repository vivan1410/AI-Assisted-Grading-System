<!DOCTYPE html>
<html>
<head>
    <title>Student Page</title>
</head>
<body>

<h2>Student Answer Submission</h2>

<label>Roll No</label><br>
<input id="roll"><br><br>

<label>Select Question</label><br>
<select id="qid" onchange="updateQuestion()">
    {% for qid in questions %}
    <option value="{{ qid }}">{{ qid }}</option>
    {% endfor %}
</select><br><br>

<p id="questionText">
    {% if questions %}
        {{ questions | list | first }}
    {% endif %}
</p>

<textarea id="answer" placeholder="Your answer"></textarea><br><br>

<button onclick="submitAnswer()">Submit</button>

<p id="result"></p>

<script>
function updateQuestion() {
    var questions = {{ questions | tojson | safe }};
    var qid = document.getElementById("qid").value;
    document.getElementById("questionText").innerText = questions[qid].question;
}

function submitAnswer() {
    fetch("/grade", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
            roll_no: document.getElementById("roll").value,
            question_id: document.getElementById("qid").value,
            student_answer: document.getElementById("answer").value
        })
    })
    .then(res => res.json())
    .then(data => {
        document.getElementById("result").innerHTML =
            "Score: " + data.score + "<br>" +
            "Feedback: " + data.feedback;
    });
}
</script>

</body>
</html>
